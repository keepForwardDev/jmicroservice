(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ca410ba"],{1566:function(e,t,a){},"1a17":function(e,t,a){"use strict";a("1566")},"4c38":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("el-container",[a("el-aside",{staticClass:"table-aside"},[a("el-scrollbar",{ref:"scrollbar",staticStyle:{height:"calc(100vh - 145px)"}},[a("div",{staticStyle:{"text-align":"center"}},[a("el-radio",{attrs:{label:"0"},on:{change:function(t){return e.getDataModel("",0)}},model:{value:e.search.showStyle,callback:function(t){e.$set(e.search,"showStyle",t)},expression:"search.showStyle"}},[e._v("按项目展示")]),a("el-radio",{attrs:{label:"1"},on:{change:function(t){return e.getDataModel("",1)}},model:{value:e.search.showStyle,callback:function(t){e.$set(e.search,"showStyle",t)},expression:"search.showStyle"}},[e._v("按数据源展示")])],1),a("el-input",{staticClass:"el-transfer-panel__filter",attrs:{clearable:"",size:"small",placeholder:"请输入搜索内容","prefix-icon":"el-icon-search"},on:{input:e.filterMatch},model:{value:e.search.tableName,callback:function(t){e.$set(e.search,"tableName",t)},expression:"search.tableName"}}),a("el-menu",{attrs:{defaultActive:e.defaultActive},on:{select:e.selectTable}},e._l(e.tableList,(function(t,l){return a("el-submenu",{key:l,attrs:{index:l+""}},[a("template",{slot:"title"},[a("i",{staticClass:"fa fa-database"}),a("span",[e._v(e._s(t.title))])]),a("transition-group",{attrs:{"enter-active-class":"animate__animated  animate__fadeInDown"}},e._l(t.tables,(function(t,l){return a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:void 0===t.show||t.show,expression:"item1.show === undefined ? true : item1.show"}],key:l+"c",attrs:{index:l+"",title:"右击修改表名称"}},[a("div",{staticStyle:{width:"300px"},on:{contextmenu:function(a){return a.preventDefault(),e.showInput(t)}}},[a("i",{staticClass:"el-icon-s-grid",staticStyle:{color:"#ff0000"}}),void 0!=t.inputVisible&&t.inputVisible?a("el-input",{ref:t.tableName,refInFor:!0,staticClass:"input-new-tag",staticStyle:{width:"200px"},attrs:{size:"small"},on:{blur:function(a){return e.handleInputConfirm(t)}},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:t.remarks,callback:function(a){e.$set(t,"remarks",a)},expression:"item1.remarks"}}):a("span",{attrs:{title:t.tableName}},[e._v(e._s(e.defaultStr(t.remarks,t.tableName)))])],1)])})),1)],2)})),1)],1)],1),a("el-container",[a("el-header",[a("div",{staticClass:"el-tabs el-tabs--top"},[a("div",{staticClass:"el-tabs__header is-top"},[a("div",{staticClass:"el-tabs__nav-wrap is-top"},[a("div",{staticClass:"el-tabs__nav-scroll"},[a("div",{staticClass:"el-tabs__nav is-top",staticStyle:{transform:"translateX(0px)"},attrs:{role:"tablist"}},[a("div",{staticClass:"el-tabs__active-bar is-top",style:{width:"56px",transform:e.tabTransform}}),a("div",{class:{"el-tabs__item":!0,"is-top":!0,"is-active":!e.dependenceShow},attrs:{id:"tab-info"},on:{click:function(t){return e.showTab(!1)}}},[e._v("基本信息 ")]),a("div",{class:{"el-tabs__item":!0,"is-top":!0,"is-active":e.dependenceShow},attrs:{id:"tab-relation"},on:{click:function(t){return e.showTab(!0)}}},[e._v("依赖关系 ")])]),a("div",{staticClass:"el-tabs__nav is-top",staticStyle:{transform:"translateX(0px)",float:"right"},attrs:{role:"tablist"}},[a("div",{class:{"el-tabs__item":!0,"actice-edit":e.editAble},attrs:{title:"编辑"},on:{click:function(t){e.editAble=!e.editAble}}},[a("i",{staticClass:"fa fa-edit",staticStyle:{"font-size":"20px"}})]),a("div",{staticClass:"el-tabs__item",attrs:{title:"保存"},on:{click:e.saveTableInfo}},[a("i",{class:{"fa fa-floppy-o":!0,enableBtn:e.saveBtn},staticStyle:{"font-size":"20px"}})]),a("div",{staticClass:"el-tabs__item",attrs:{title:"下载"},on:{click:function(t){e.tableList.length>0&&(e.dialogFormVisible=!0)}}},[a("i",{class:{"fa fa-download":!0,enableBtn:0===e.tableList.length},staticStyle:{"font-size":"20px"}})])])])])])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.dependenceShow,expression:"!dependenceShow"}]},[a("el-scrollbar",{staticClass:"table-content",staticStyle:{height:"calc(100vh - 203px)"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),a("el-table-column",{attrs:{prop:"columnName",label:"名称",width:"140"}}),a("el-table-column",{attrs:{prop:"typeName",label:"数据类型",width:"120"}}),a("el-table-column",{attrs:{prop:"columnSize",label:"长度"}}),a("el-table-column",{attrs:{prop:"decimalDigits",label:"精度（小数位）"}}),a("el-table-column",{attrs:{prop:"nullable",label:"允许空值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(" "+e._s(t.row.nullable)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"primaryKey",label:"主键"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(" "+e._s(t.row.primaryKey)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"columnDef",label:"默认值"}}),e.editAble?a("el-table-column",{attrs:{prop:"remark",label:"说明"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:""},model:{value:t.row.remarks,callback:function(a){e.$set(t.row,"remarks",a)},expression:"scope.row.remarks"}})]}}],null,!1,1491102561)}):e._e(),e.editAble?e._e():a("el-table-column",{attrs:{prop:"remark",label:"说明 "},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.remarks}},[e._v(" "+e._s(t.row.remarks)+" ")])]}}],null,!1,2738036810)})],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.dependenceShow,expression:"dependenceShow"}],staticStyle:{height:"calc(100vh - 203px)"},attrs:{id:"echart"}})],1)],1),a("el-dialog",{attrs:{title:"选择导出的格式",width:"500px",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("div",[e._v(" 导出方式： "),a("el-radio",{attrs:{label:"0"},model:{value:e.downloadStyle,callback:function(t){e.downloadStyle=t},expression:"downloadStyle"}},[e._v("按项目导出")]),a("el-radio",{attrs:{label:"1"},model:{value:e.downloadStyle,callback:function(t){e.downloadStyle=t},expression:"downloadStyle"}},[e._v("按数据源导出")])],1),a("div",{staticStyle:{"margin-top":"20px"}},[e._v(" 导出的表： "),a("el-select",{staticStyle:{width:"80%"},attrs:{filterable:"",clearable:"",multiple:"",placeholder:"请选择"},model:{value:e.downloadSelectTables,callback:function(t){e.downloadSelectTables=t},expression:"downloadSelectTables"}},e._l(e.tableSelections,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",{staticStyle:{"margin-top":"20px"}},[e._v(" 文件类型： "),a("el-radio",{attrs:{label:"0"},model:{value:e.fileStyle,callback:function(t){e.fileStyle=t},expression:"fileStyle"}},[e._v("EXCEL")]),a("el-radio",{attrs:{label:"1"},model:{value:e.fileStyle,callback:function(t){e.fileStyle=t},expression:"fileStyle"}},[e._v("WORD")]),a("el-radio",{attrs:{label:"2"},model:{value:e.fileStyle,callback:function(t){e.fileStyle=t},expression:"fileStyle"}},[e._v("HTML")]),a("el-radio",{attrs:{label:"3"},model:{value:e.fileStyle,callback:function(t){e.fileStyle=t},expression:"fileStyle"}},[e._v("MD")])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.downloadFile}},[e._v("导出")])],1)])],1)},i=[],s=(a("3fab"),a("814e"),a("a9b6"),a("c284"),a("44ad"),a("6794"),a("3e22"),a("fd0d")),n={name:"meta-manage",data:function(){return{defaultActive:"0",tableList:[],tableData:[],tableSelections:[],tableLoading:!1,tabName:"info",dataSourceInfoId:"",dataSourceList:[],search:{showStyle:"0",tableName:""},editAble:!1,editItem:{},editTableName:"",dialogFormVisible:!1,downloadStyle:"0",fileStyle:"0",downloadSelectTables:[],dependenceShow:!1,tabTransform:"translateX(0px)"}},filters:{boolString:function(e){return e?"Y":"N"}},computed:{saveBtn:function(){return!(this.editAble&&this.tableData.length>0)}},mounted:function(){this.getDataModel("",this.search.showStyle)},methods:{selectTable:function(e,t){this.editItem=this.tableList[t[0]].tables[t[1]],this.getColumnModel(),this.dependenceShow&&this.getOption()},filterMatch:function(){var e=this;this.search.tableName?this.tableList.forEach((function(t){t.tables.forEach((function(t){t.remarks.indexOf(e.search.tableName)>-1||t.tableName.indexOf(e.search.tableName)>-1?t.show=!0:t.show=!1}))})):this.tableList.forEach((function(e){e.tables.forEach((function(e){e.show=!0}))}))},handleInputConfirm:function(e){e.inputVisible=!1,this.saveTableInfo(),this.$forceUpdate()},showInput:function(e){var t=this;e.inputVisible=!0,this.editAble=!0,this.editItem=e,this.editTableName=e.remarks,this.$forceUpdate(),this.$nextTick((function(a){t.$refs[e.tableName][0].$refs.input.focus()}))},saveTableInfo:function(){var e=this;this.editAble&&this.$postJson("/datacenter/metadata/saveTableInfo",this.editItem).then((function(t){1===t.code&&(e.editAble=!1,e.$message.success(t.msg))}))},getDataModel:function(e,t){var a=this;this.search.tableName="",this.$get("/datacenter/metadata/getTableInfo",{tableName:e,groupType:t}).then((function(e){1===e.code&&(a.tableList=e.data,a.tableList.length>0&&(a.editItem=a.tableList[0].tables[0],a.getColumnModel(),a.tableList.forEach((function(e){e.tables.forEach((function(e){a.tableSelections.push({label:e.remarks+"-"+e.tableName,value:e.id})}))}))))}))},getColumnModel:function(){var e=this,t="/datacenter/metadata/getColumnModel/"+this.editItem.id;this.editItem.columns?this.tableData=this.editItem.columns:(this.tableLoading=!0,this.$get(t).then((function(t){1===t.code&&setTimeout((function(){e.tableData=t.data,e.editItem.columns=t.data,e.tableLoading=!1}),500)})))},defaultStr:function(e,t){return e||t},downloadFile:function(){location.href="/datacenter/metadata/downloadTableInfo?groupType=".concat(this.downloadStyle,"&fileType=").concat(this.fileStyle,"&ids=").concat(this.downloadSelectTables.join(","))},showTab:function(e){e!==this.dependenceShow&&(e?(this.getOption(),this.tabTransform="translateX(96px)"):this.tabTransform="translateX(0px)",this.dependenceShow=e)},initEchart:function(e,t){var a=document.getElementById(e),l=s["b"](a);l.setOption(t,!0)},getOption:function(){var e=this;this.$get("/datacenter/metadata/getTableRelation/"+this.editItem.id).then((function(t){if(1===t.code){var a={title:{text:"依赖关系",show:!1},series:[{type:"graph",layout:"force",symbolSize:58,draggable:!0,roam:!0,focusNodeAdjacency:!0,edgeSymbol:["","arrow"],edgeLabel:{normal:{show:!0,textStyle:{fontSize:20},formatter:function(e){return e.data.name}}},label:{show:!0,formatter:function(e){return e.data.nickName}},force:{repulsion:2e3,edgeLength:120},data:t.data.data,links:t.data.links}]};e.initEchart("echart",a)}}))}}},o=n,r=(a("1a17"),a("cba8")),c=Object(r["a"])(o,l,i,!1,null,"a1b1943a",null);t["default"]=c.exports}}]);